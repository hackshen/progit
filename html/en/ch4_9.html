<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Git Daemon - Git on the Server - Pro Git</title><link rel="stylesheet" type="text/css" href="../../assets/vendor/bootstrap/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="../../assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" type="text/css" href="../../assets/vendor/nprogress/nprogress.css"><link rel="stylesheet" type="text/css" href="../../assets/css/main.css"><link rel="shortcut icon" type="images/x-icon" href="../../assets/img/favicon.ico"></head><body><a href="#main" class="sr-only">SKIP TO CONTENT</a><div id="pjax-container"><div id="header" class="navbar navbar-fixed-top navbar-inverse"><div class="container"><div class="navbar-header"><a id="brand" href="/progit/"><img src="../../assets/img/git-logo.png" alt="git" class="logo"></a><button type="button" data-toggle="collapse" data-target=".navigation" class="navbar-toggle"><span class="sr-only">Toggle Navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="navbar-collapse collapse navigation"><ul class="nav navbar-nav"><li class="dropdown"><a data-toggle="dropdown" href="#" class="dropdown-toggle"><span class="octicon octicon-list-unordered"></span> Table Of Contents<b class="caret"></b></a><ul role="menu" class="dropdown-menu menu-toc"><li class="menu-toc-chapter"><a href="ch1_0.html">1   Getting Started </a><ul class="menu-section-links"><li><a href="ch1_1.html">1.1   About Version Control </a></li><li><a href="ch1_2.html">1.2   A Short History of Git </a></li><li><a href="ch1_3.html">1.3   Git Basics </a></li><li><a href="ch1_4.html">1.4   Installing Git </a></li><li><a href="ch1_5.html">1.5   First-Time Git Setup </a></li><li><a href="ch1_6.html">1.6   Getting Help </a></li><li><a href="ch1_7.html">1.7   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch2_0.html">2   Git Basics </a><ul class="menu-section-links"><li><a href="ch2_1.html">2.1   Getting a Git Repository </a></li><li><a href="ch2_2.html">2.2   Recording Changes to the Repository </a></li><li><a href="ch2_3.html">2.3   Viewing the Commit History </a></li><li><a href="ch2_4.html">2.4   Undoing Things </a></li><li><a href="ch2_5.html">2.5   Working with Remotes </a></li><li><a href="ch2_6.html">2.6   Tagging </a></li><li><a href="ch2_7.html">2.7   Tips and Tricks </a></li><li><a href="ch2_8.html">2.8   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch3_0.html">3   Git Branching </a><ul class="menu-section-links"><li><a href="ch3_1.html">3.1   What a Branch Is </a></li><li><a href="ch3_2.html">3.2   Basic Branching and Merging </a></li><li><a href="ch3_3.html">3.3   Branch Management </a></li><li><a href="ch3_4.html">3.4   Branching Workflows </a></li><li><a href="ch3_5.html">3.5   Remote Branches </a></li><li><a href="ch3_6.html">3.6   Rebasing </a></li><li><a href="ch3_7.html">3.7   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch4_0.html">4   Git on the Server </a><ul class="menu-section-links"><li><a href="ch4_1.html">4.1   The Protocols </a></li><li><a href="ch4_2.html">4.2   Getting Git on a Server </a></li><li><a href="ch4_3.html">4.3   Generating Your SSH Public Key </a></li><li><a href="ch4_4.html">4.4   Setting Up the Server </a></li><li><a href="ch4_5.html">4.5   Public Access </a></li><li><a href="ch4_6.html">4.6   GitWeb </a></li><li><a href="ch4_7.html">4.7   Gitosis </a></li><li><a href="ch4_8.html">4.8   Gitolite </a></li><li><a href="ch4_9.html">4.9   Git Daemon </a></li><li><a href="ch4_10.html">4.10   Hosted Git </a></li><li><a href="ch4_11.html">4.11   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch5_0.html">5   Distributed Git </a><ul class="menu-section-links"><li><a href="ch5_1.html">5.1   Distributed Workflows </a></li><li><a href="ch5_2.html">5.2   Contributing to a Project </a></li><li><a href="ch5_3.html">5.3   Maintaining a Project </a></li><li><a href="ch5_4.html">5.4   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch6_0.html">6   Git Tools </a><ul class="menu-section-links"><li><a href="ch6_1.html">6.1   Revision Selection </a></li><li><a href="ch6_2.html">6.2   Interactive Staging </a></li><li><a href="ch6_3.html">6.3   Stashing </a></li><li><a href="ch6_4.html">6.4   Rewriting History </a></li><li><a href="ch6_5.html">6.5   Debugging with Git </a></li><li><a href="ch6_6.html">6.6   Submodules </a></li><li><a href="ch6_7.html">6.7   Subtree Merging </a></li><li><a href="ch6_8.html">6.8   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch7_0.html">7   Customizing Git </a><ul class="menu-section-links"><li><a href="ch7_1.html">7.1   Git Configuration </a></li><li><a href="ch7_2.html">7.2   Git Attributes </a></li><li><a href="ch7_3.html">7.3   Git Hooks </a></li><li><a href="ch7_4.html">7.4   An Example Git-Enforced Policy </a></li><li><a href="ch7_5.html">7.5   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch8_0.html">8   Git and Other Systems </a><ul class="menu-section-links"><li><a href="ch8_1.html">8.1   Git and Subversion </a></li><li><a href="ch8_2.html">8.2   Migrating to Git </a></li><li><a href="ch8_3.html">8.3   Summary </a></li></ul></li><li class="menu-toc-chapter"><a href="ch9_0.html">9   Git Internals </a><ul class="menu-section-links"><li><a href="ch9_1.html">9.1   Plumbing and Porcelain </a></li><li><a href="ch9_2.html">9.2   Git Objects </a></li><li><a href="ch9_3.html">9.3   Git References </a></li><li><a href="ch9_4.html">9.4   Packfiles </a></li><li><a href="ch9_5.html">9.5   The Refspec </a></li><li><a href="ch9_6.html">9.6   Transfer Protocols </a></li><li><a href="ch9_7.html">9.7   Maintenance and Data Recovery </a></li><li><a href="ch9_8.html">9.8   Summary </a></li></ul></li></ul></li></ul><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a data-toggle="dropdown" href="#" class="dropdown-toggle"><span class="octicon octicon-globe"></span> Other Translations<b class="caret"></b></a><ul role="menu" class="dropdown-menu"><li><a href="../../index.en.html">English</a></li><li><a href="../../index.html">简体中文</a></li><li><a href="../../index.zh-tw.html">正體中文</a></li></ul></li><li><a href="../../about.html"><span class="octicon octicon-question"></span> About</a></li></ul></div></div></div><div id="main" class="container"><div class="row wrap"><div class="col-md-4"><div class="ph20"> <ul class="nav sub-nav"><li class="nav-header"><a href="ch4_0.html">Git on the Server</a></li><li><a href="ch4_1.html">The Protocols</a></li><li><a href="ch4_2.html">Getting Git on a Server</a></li><li><a href="ch4_3.html">Generating Your SSH Public Key</a></li><li><a href="ch4_4.html">Setting Up the Server</a></li><li><a href="ch4_5.html">Public Access</a></li><li><a href="ch4_6.html">GitWeb</a></li><li><a href="ch4_7.html">Gitosis</a></li><li><a href="ch4_8.html">Gitolite</a></li><li><a href="ch4_9.html">Git Daemon</a></li><li><a href="ch4_10.html">Hosted Git</a></li><li><a href="ch4_11.html">Summary</a></li></ul></div></div><div class="col-md-8"><div class="ph20"><h2>Git Daemon</h2>

<p>For public, unauthenticated read access to your projects, you’ll want to move past the HTTP protocol and start using the Git protocol. The main reason is speed. The Git protocol is far more efficient and thus faster than the HTTP protocol, so using it will save your users time.</p>

<p>Again, this is for unauthenticated read-only access. If you’re running this on a server outside your firewall, it should only be used for projects that are publicly visible to the world. If the server you’re running it on is inside your firewall, you might use it for projects that a large number of people or computers (continuous integration or build servers) have read-only access to, when you don’t want to have to add an SSH key for each.</p>

<p>In any case, the Git protocol is relatively easy to set up. Basically, you need to run this command in a daemonized manner:</p>

<pre><code>git daemon --reuseaddr --base-path=/opt/git/ /opt/git/</code></pre>

<p><code>--reuseaddr</code> allows the server to restart without waiting for old connections to time out, the <code>--base-path</code> option allows people to clone projects without specifying the entire path, and the path at the end tells the Git daemon where to look for repositories to export. If you’re running a firewall, you’ll also need to punch a hole in it at port 9418 on the box you’re setting this up on.</p>

<p>You can daemonize this process a number of ways, depending on the operating system you’re running. On an Ubuntu machine, you use an Upstart script. So, in the following file</p>

<pre><code>/etc/event.d/local-git-daemon</code></pre>

<p>you put this script:</p>

<pre><code>start on startup
stop on shutdown
exec /usr/bin/git daemon \
    --user=git --group=git \
    --reuseaddr \
    --base-path=/opt/git/ \
    /opt/git/
respawn</code></pre>

<p>For security reasons, it is strongly encouraged to have this daemon run as a user with read-only permissions to the repositories — you can easily do this by creating a new user &#39;git-ro&#39; and running the daemon as them.  For the sake of simplicity we’ll simply run it as the same &#39;git&#39; user that Gitosis is running as.</p>

<p>When you restart your machine, your Git daemon will start automatically and respawn if it goes down. To get it running without having to reboot, you can run this:</p>

<pre><code>initctl start local-git-daemon</code></pre>

<p>On other systems, you may want to use <code>xinetd</code>, a script in your <code>sysvinit</code> system, or something else — as long as you get that command daemonized and watched somehow.</p>

<p>Next, you have to tell your Gitosis server which repositories to allow unauthenticated Git server-based access to. If you add a section for each repository, you can specify the ones from which you want your Git daemon to allow reading. If you want to allow Git protocol access for the <code>iphone_project</code>, you add this to the end of the <code>gitosis.conf</code> file:</p>

<pre><code>[repo iphone_project]
daemon = yes</code></pre>

<p>When that is committed and pushed up, your running daemon should start serving requests for the project to anyone who has access to port 9418 on your server.</p>

<p>If you decide not to use Gitosis, but you want to set up a Git daemon, you’ll have to run this on each project you want the Git daemon to serve:</p>

<pre><code>$ cd /path/to/project.git
$ touch git-daemon-export-ok</code></pre>

<p>The presence of that file tells Git that it’s OK to serve this project without authentication.</p>

<p>Gitosis can also control which projects GitWeb shows. First, you need to add something like the following to the <code>/etc/gitweb.conf</code> file:</p>

<pre><code>$projects_list = &quot;/home/git/gitosis/projects.list&quot;;
$projectroot = &quot;/home/git/repositories&quot;;
$export_ok = &quot;git-daemon-export-ok&quot;;
@git_base_url_list = (&#39;git://gitserver&#39;);</code></pre>

<p>You can control which projects GitWeb lets users browse by adding or removing a <code>gitweb</code> setting in the Gitosis configuration file. For instance, if you want the <code>iphone_project</code> to show up on GitWeb, you make the <code>repo</code> setting look like this:</p>

<pre><code>[repo iphone_project]
daemon = yes
gitweb = yes</code></pre>

<p>Now, if you commit and push the project, GitWeb will automatically start showing the <code>iphone_project</code>.</p>

</div></div></div><div class="footer"><div class="pull-left"><span class="build-date">Build at: 2020-04-19 16:14:36</span>,<span class="build-source-version">Source revision:</span>,<span class="application-version">Application version: 0.0.7</span>.</div><div class="pull-right">Made by<a href="http://hackshen.com" target="_blank"> Hshen</a></div></div></div></div><script src="../../assets/vendor/jquery/dist/jquery.min.js"></script><script src="../../assets/vendor/jquery-pjax/jquery.pjax.js"></script><script src="../../assets/vendor/nprogress/nprogress.js"></script><script src="../../assets/vendor/bootstrap/dist/js/bootstrap.min.js"></script><script src="../../assets/js/main.js"></script></body></html>